# ============================================
# GRC Master - Role-Based Access Control (RBAC) Configuration
# ============================================
# This file defines the complete RBAC structure for the system
# Copy to .env and customize for your environment

# ============================================
# RBAC SYSTEM CONFIGURATION
# ============================================
VITE_RBAC_ENABLED=true
VITE_RBAC_STRICT_MODE=true
VITE_RBAC_CACHE_TTL=3600
VITE_RBAC_LOG_ACCESS_DENIED=true

# ============================================
# ROLE HIERARCHY (Lower number = Higher priority)
# ============================================
VITE_ROLE_SUPER_ADMIN_LEVEL=0
VITE_ROLE_SYSTEM_ADMIN_LEVEL=1
VITE_ROLE_TENANT_ADMIN_LEVEL=2
VITE_ROLE_ORG_ADMIN_LEVEL=3
VITE_ROLE_MANAGER_LEVEL=4
VITE_ROLE_AUDITOR_LEVEL=5
VITE_ROLE_ANALYST_LEVEL=6
VITE_ROLE_USER_LEVEL=7
VITE_ROLE_VIEWER_LEVEL=8
VITE_ROLE_GUEST_LEVEL=9

# ============================================
# SUPER ADMIN PERMISSIONS (Level 0 - Full System Access)
# ============================================
VITE_SUPER_ADMIN_PERMISSIONS=system:*,tenants:*,users:*,organizations:*,frameworks:*,controls:*,assessments:*,reports:*,audit:*,settings:*,roles:*,permissions:*

# ============================================
# SYSTEM ADMIN PERMISSIONS (Level 1 - System Management)
# ============================================
VITE_SYSTEM_ADMIN_PERMISSIONS=tenants:read,tenants:create,tenants:update,users:*,organizations:read,frameworks:*,controls:*,assessments:read,reports:*,audit:read,settings:update

# ============================================
# TENANT ADMIN PERMISSIONS (Level 2 - Tenant Management)
# ============================================
VITE_TENANT_ADMIN_PERMISSIONS=users:read,users:create,users:update,organizations:*,frameworks:read,frameworks:assign,controls:read,controls:assign,assessments:*,reports:read,audit:read,settings:update

# ============================================
# ORGANIZATION ADMIN PERMISSIONS (Level 3 - Organization Management)
# ============================================
VITE_ORG_ADMIN_PERMISSIONS=users:read,users:invite,organizations:read,organizations:update,frameworks:read,controls:read,assessments:*,reports:read,evidence:*,workorders:*

# ============================================
# MANAGER PERMISSIONS (Level 4 - Team Management)
# ============================================
VITE_MANAGER_PERMISSIONS=users:read,organizations:read,frameworks:read,controls:read,assessments:create,assessments:update,assessments:assign,reports:read,evidence:create,evidence:update,workorders:*

# ============================================
# AUDITOR PERMISSIONS (Level 5 - Audit & Compliance)
# ============================================
VITE_AUDITOR_PERMISSIONS=organizations:read,frameworks:read,controls:read,assessments:read,assessments:review,assessments:approve,reports:read,reports:generate,evidence:read,evidence:verify,audit:read

# ============================================
# ANALYST PERMISSIONS (Level 6 - Analysis & Reporting)
# ============================================
VITE_ANALYST_PERMISSIONS=organizations:read,frameworks:read,controls:read,assessments:read,reports:read,reports:generate,evidence:read,metrics:read

# ============================================
# USER PERMISSIONS (Level 7 - Standard User)
# ============================================
VITE_USER_PERMISSIONS=organizations:read,frameworks:read,controls:read,assessments:read,assessments:contribute,evidence:create,evidence:read,workorders:read,workorders:update

# ============================================
# VIEWER PERMISSIONS (Level 8 - Read-Only)
# ============================================
VITE_VIEWER_PERMISSIONS=organizations:read,frameworks:read,controls:read,assessments:read,reports:read,evidence:read

# ============================================
# GUEST PERMISSIONS (Level 9 - Limited Access)
# ============================================
VITE_GUEST_PERMISSIONS=organizations:read,frameworks:read:public

# ============================================
# RESOURCE PERMISSIONS MAPPING
# ============================================

# System Resources
VITE_PERMISSION_SYSTEM_MANAGE=system:manage
VITE_PERMISSION_SYSTEM_MONITOR=system:monitor
VITE_PERMISSION_SYSTEM_CONFIG=system:config

# Tenant Resources
VITE_PERMISSION_TENANTS_CREATE=tenants:create
VITE_PERMISSION_TENANTS_READ=tenants:read
VITE_PERMISSION_TENANTS_UPDATE=tenants:update
VITE_PERMISSION_TENANTS_DELETE=tenants:delete
VITE_PERMISSION_TENANTS_MANAGE=tenants:*

# User Resources
VITE_PERMISSION_USERS_CREATE=users:create
VITE_PERMISSION_USERS_READ=users:read
VITE_PERMISSION_USERS_UPDATE=users:update
VITE_PERMISSION_USERS_DELETE=users:delete
VITE_PERMISSION_USERS_INVITE=users:invite
VITE_PERMISSION_USERS_MANAGE=users:*

# Organization Resources
VITE_PERMISSION_ORGS_CREATE=organizations:create
VITE_PERMISSION_ORGS_READ=organizations:read
VITE_PERMISSION_ORGS_UPDATE=organizations:update
VITE_PERMISSION_ORGS_DELETE=organizations:delete
VITE_PERMISSION_ORGS_MANAGE=organizations:*

# Framework Resources
VITE_PERMISSION_FRAMEWORKS_CREATE=frameworks:create
VITE_PERMISSION_FRAMEWORKS_READ=frameworks:read
VITE_PERMISSION_FRAMEWORKS_UPDATE=frameworks:update
VITE_PERMISSION_FRAMEWORKS_DELETE=frameworks:delete
VITE_PERMISSION_FRAMEWORKS_ASSIGN=frameworks:assign
VITE_PERMISSION_FRAMEWORKS_IMPORT=frameworks:import
VITE_PERMISSION_FRAMEWORKS_EXPORT=frameworks:export

# Control Resources
VITE_PERMISSION_CONTROLS_CREATE=controls:create
VITE_PERMISSION_CONTROLS_READ=controls:read
VITE_PERMISSION_CONTROLS_UPDATE=controls:update
VITE_PERMISSION_CONTROLS_DELETE=controls:delete
VITE_PERMISSION_CONTROLS_ASSIGN=controls:assign

# Assessment Resources
VITE_PERMISSION_ASSESSMENTS_CREATE=assessments:create
VITE_PERMISSION_ASSESSMENTS_READ=assessments:read
VITE_PERMISSION_ASSESSMENTS_UPDATE=assessments:update
VITE_PERMISSION_ASSESSMENTS_DELETE=assessments:delete
VITE_PERMISSION_ASSESSMENTS_ASSIGN=assessments:assign
VITE_PERMISSION_ASSESSMENTS_REVIEW=assessments:review
VITE_PERMISSION_ASSESSMENTS_APPROVE=assessments:approve
VITE_PERMISSION_ASSESSMENTS_CONTRIBUTE=assessments:contribute

# Report Resources
VITE_PERMISSION_REPORTS_CREATE=reports:create
VITE_PERMISSION_REPORTS_READ=reports:read
VITE_PERMISSION_REPORTS_GENERATE=reports:generate
VITE_PERMISSION_REPORTS_EXPORT=reports:export
VITE_PERMISSION_REPORTS_SCHEDULE=reports:schedule

# Evidence Resources
VITE_PERMISSION_EVIDENCE_CREATE=evidence:create
VITE_PERMISSION_EVIDENCE_READ=evidence:read
VITE_PERMISSION_EVIDENCE_UPDATE=evidence:update
VITE_PERMISSION_EVIDENCE_DELETE=evidence:delete
VITE_PERMISSION_EVIDENCE_VERIFY=evidence:verify
VITE_PERMISSION_EVIDENCE_APPROVE=evidence:approve

# Work Order Resources
VITE_PERMISSION_WORKORDERS_CREATE=workorders:create
VITE_PERMISSION_WORKORDERS_READ=workorders:read
VITE_PERMISSION_WORKORDERS_UPDATE=workorders:update
VITE_PERMISSION_WORKORDERS_DELETE=workorders:delete
VITE_PERMISSION_WORKORDERS_ASSIGN=workorders:assign

# Audit Resources
VITE_PERMISSION_AUDIT_READ=audit:read
VITE_PERMISSION_AUDIT_EXPORT=audit:export

# Settings Resources
VITE_PERMISSION_SETTINGS_READ=settings:read
VITE_PERMISSION_SETTINGS_UPDATE=settings:update
VITE_PERMISSION_SETTINGS_MANAGE=settings:*

# ============================================
# FEATURE FLAGS BY ROLE
# ============================================
VITE_SUPER_ADMIN_FEATURES=dashboard,analytics,users,organizations,frameworks,controls,assessments,reports,evidence,workorders,audit,settings,system,api
VITE_SYSTEM_ADMIN_FEATURES=dashboard,analytics,users,organizations,frameworks,controls,assessments,reports,audit,settings
VITE_TENANT_ADMIN_FEATURES=dashboard,analytics,users,organizations,frameworks,controls,assessments,reports,settings
VITE_ORG_ADMIN_FEATURES=dashboard,users,frameworks,controls,assessments,reports,evidence,workorders
VITE_MANAGER_FEATURES=dashboard,assessments,reports,evidence,workorders
VITE_AUDITOR_FEATURES=dashboard,frameworks,controls,assessments,reports,evidence,audit
VITE_ANALYST_FEATURES=dashboard,analytics,frameworks,controls,assessments,reports
VITE_USER_FEATURES=dashboard,assessments,evidence,workorders
VITE_VIEWER_FEATURES=dashboard,reports
VITE_GUEST_FEATURES=dashboard

# ============================================
# ACCESS CONTROL RULES
# ============================================

# Session Configuration
VITE_SESSION_TIMEOUT=3600
VITE_SESSION_REFRESH_INTERVAL=300
VITE_MAX_CONCURRENT_SESSIONS=3

# IP Restriction (comma-separated IPs or CIDR ranges)
VITE_SUPER_ADMIN_ALLOWED_IPS=0.0.0.0/0
VITE_SYSTEM_ADMIN_ALLOWED_IPS=0.0.0.0/0

# Time-based Access Control
VITE_ENABLE_TIME_BASED_ACCESS=false
VITE_BUSINESS_HOURS_START=08:00
VITE_BUSINESS_HOURS_END=18:00
VITE_RESTRICTED_ROLES=guest,viewer

# MFA Requirements by Role
VITE_MFA_REQUIRED_ROLES=super_admin,system_admin,tenant_admin
VITE_MFA_RECOMMENDED_ROLES=org_admin,manager,auditor

# Password Policy by Role
VITE_SUPER_ADMIN_PASSWORD_MIN_LENGTH=16
VITE_ADMIN_PASSWORD_MIN_LENGTH=12
VITE_USER_PASSWORD_MIN_LENGTH=8

# ============================================
# AUDIT & LOGGING
# ============================================
VITE_AUDIT_ALL_ACTIONS=true
VITE_AUDIT_FAILED_ACCESS_ATTEMPTS=true
VITE_AUDIT_ROLE_CHANGES=true
VITE_AUDIT_PERMISSION_CHANGES=true
VITE_LOG_SENSITIVE_OPERATIONS=true

# ============================================
# RBAC ENFORCEMENT LAYERS
# ============================================
VITE_ENFORCE_FRONTEND_RBAC=true
VITE_ENFORCE_API_RBAC=true
VITE_ENFORCE_DATABASE_RBAC=true
VITE_ENFORCE_FILE_RBAC=true

# ============================================
# DEFAULT ROLES FOR NEW USERS
# ============================================
VITE_DEFAULT_ROLE_NEW_USER=user
VITE_DEFAULT_ROLE_INVITED_USER=user
VITE_DEFAULT_ROLE_SELF_REGISTERED=viewer

# ============================================
# ROLE ESCALATION RULES
# ============================================
VITE_ALLOW_ROLE_ESCALATION=false
VITE_REQUIRE_APPROVAL_FOR_ESCALATION=true
VITE_ESCALATION_APPROVAL_ROLES=super_admin,system_admin
VITE_MAX_ESCALATION_LEVEL=3

# ============================================
# API KEYS & SERVICE ACCOUNTS
# ============================================
VITE_ALLOW_API_KEY_AUTH=true
VITE_API_KEY_ROLES=viewer,user,analyst
VITE_SERVICE_ACCOUNT_ENABLED=true
VITE_SERVICE_ACCOUNT_MAX_LEVEL=5

# ============================================
# CUSTOM ROLE DEFINITIONS (JSON format)
# ============================================
# Example: VITE_CUSTOM_ROLES='[{"name":"compliance_officer","level":5,"permissions":["frameworks:*","assessments:*","reports:*"]}]'
VITE_CUSTOM_ROLES=[]

# ============================================
# INTEGRATION SETTINGS
# ============================================
VITE_LDAP_ROLE_MAPPING=false
VITE_SAML_ROLE_ATTRIBUTE=role
VITE_OAUTH_ROLE_CLAIM=roles
VITE_SYNC_ROLES_FROM_EXTERNAL=false
